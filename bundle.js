(()=>{"use strict";const t=require("express"),r=require("express-session"),e=require("axios"),n=require("dotenv");function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,a=Object.defineProperty||function(t,r,e){t[r]=e.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{f({},"")}catch(t){f=function(t,r,e){return t[r]=e}}function h(t,r,e,n){var o=r&&r.prototype instanceof w?r:w,i=Object.create(o.prototype),c=new A(n||[]);return a(i,"_invoke",{value:S(t,e,c)}),i}function p(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=h;var y="suspendedStart",v="suspendedYield",d="executing",g="completed",m={};function w(){}function b(){}function x(){}var L={};f(L,u,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(N([])));E&&E!==e&&n.call(E,u)&&(L=E);var k=x.prototype=w.prototype=Object.create(L);function O(t){["next","throw","return"].forEach((function(r){f(t,r,(function(t){return this._invoke(r,t)}))}))}function j(t,r){function e(i,a,c,u){var s=p(t[i],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==o(f)&&n.call(f,"__await")?r.resolve(f.__await).then((function(t){e("next",t,c,u)}),(function(t){e("throw",t,c,u)})):r.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return e("throw",t,c,u)}))}u(s.arg)}var i;a(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function S(r,e,n){var o=y;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=p(r,e,n);if("normal"===s.type){if(o=n.done?g:v,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=g,n.method="throw",n.arg=s.arg)}}}function P(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,P(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=p(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,m):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function I(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function T(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function N(r){if(r||""===r){var e=r[u];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var i=-1,a=function e(){for(;++i<r.length;)if(n.call(r,i))return e.value=r[i],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(o(r)+" is not iterable")}return b.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=f(x,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===b||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},O(j.prototype),f(j.prototype,s,(function(){return this})),r.AsyncIterator=j,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new j(h(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(k),f(k,l,"Generator"),f(k,u,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),m},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),T(e),m}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;T(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:N(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),m}},r}function a(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}var c=function(){console.log("Server is listening on port ".concat(process.env.SERVER_PORT))};function u(t){if("listen"!==t.syscall)throw t;var r="string"==typeof port?"Pipe ".concat(port):"Port  ".concat(port);switch(t.code){case"EACCES":console.error("".concat(r," requires elevated privileges")),process.exit(1);break;case"EADDRINUSE":console.error("".concat(r," is already in use")),process.exit(1);break;default:throw console.log("I CAN LOG ERRORS HERE"),t}}var s=function(){var t,r=(t=i().mark((function t(r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{r.listen(process.env.SERVER_PORT,c).on("error",u)}catch(t){console.error(t)}case 1:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function c(t){a(i,n,o,c,u,"next",t)}function u(t){a(i,n,o,c,u,"throw",t)}c(void 0)}))});return function(t){return r.apply(this,arguments)}}();const l=require("cookie-parser");function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function h(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */h=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof w?r:w,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:S(t,e,c)}),a}function p(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var y="suspendedStart",v="suspendedYield",d="executing",g="completed",m={};function w(){}function b(){}function x(){}var L={};s(L,a,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(N([])));E&&E!==e&&n.call(E,a)&&(L=E);var k=x.prototype=w.prototype=Object.create(L);function O(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function j(t,r){function e(o,i,a,c){var u=p(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==f(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function S(r,e,n){var o=y;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===y)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=p(r,e,n);if("normal"===s.type){if(o=n.done?g:v,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=g,n.method="throw",n.arg=s.arg)}}}function P(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,P(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=p(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,m):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function I(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function T(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function N(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(f(r)+" is not iterable")}return b.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:b,configurable:!0}),b.displayName=s(x,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===b||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},O(j.prototype),s(j.prototype,c,(function(){return this})),r.AsyncIterator=j,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new j(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),m},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),T(e),m}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;T(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:N(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),m}},r}function p(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function y(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){p(i,n,o,a,c,"next",t)}function c(t){p(i,n,o,a,c,"throw",t)}a(void 0)}))}}const v=function(){var r=t.Router();return r.get("/",function(){var t=y(h().mark((function t(r,e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.status(200).json({success:!0,message:"Success"})}catch(t){e.status(500).json({success:!1,message:t})}case 1:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}()),r.post("/",function(){var t=y(h().mark((function t(r,e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.status(200).json({success:!0,message:"Post Success"})}catch(t){e.status(500).json({success:!1,message:t})}case 1:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}()),r},d=require("path"),g=require("fs"),m=require("multer");require("date-fns");new Date(864e13),new Date(1970,1,1);var w=new Date;w.getFullYear();function b(t){if(!t||19===!t.length)return[null,null];var r=t.split(" ");return[r[0],r[1]]}require("url");var x={Id:"2",Name:"GET A ROOF",RENTALTYPES:["CONDO","HOUSE","ROOM","SHARED"]};function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function _(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new A(n||[]);return o(a,"_invoke",{value:S(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(N([])));E&&E!==e&&n.call(E,a)&&(b=E);var k=w.prototype=g.prototype=Object.create(b);function O(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function j(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==L(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function S(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=P(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function P(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,P(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function I(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function T(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function N(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(L(r)+" is not iterable")}return m.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},O(j.prototype),s(j.prototype,c,(function(){return this})),r.AsyncIterator=j,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new j(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(k),s(k,u,"Generator"),s(k,a,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=N,A.prototype={constructor:A,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),T(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;T(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:N(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function E(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function k(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return O(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?O(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw i}}}}function O(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}var j=(0,d.dirname)(process.argv[1]),S=d.join(j,"public"),P=d.join(j,"public/uploads".concat(x.Id)),I=d.join(j,"templates");console.log("FOLDER_ROOT      = ",j),console.log("FOLDER_WEBROOT   = ",S),console.log("FOLDER_UPLOADS   = ",P),console.log("FOLDER_TEMPLATES = ",I);var T="/uploads".concat(x.Id);function A(t,r){var e=d.join(P,""+t,""+r);return g.existsSync(e)?g.readdirSync(e,{withFileTypes:!0}).filter((function(t){return!t.isDirectory()})).sort((function(t,r){return t.name.localeCompare(r.name)})).map((function(e){return"".concat(T,"/").concat(t,"/").concat(r,"/").concat(e.name)})):[]}function N(t){return G.apply(this,arguments)}function G(){var t;return t=_().mark((function t(r){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,g.existsSync(r)){t.next=3;break}return t.abrupt("return");case 3:g.unlinkSync(r),console.log("".concat(r," was deleted successfully.")),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),"ENOENT"===t.t0.code?console.log("File does not exist at path: ".concat(r)):console.error("An error occurred: ".concat(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})),G=function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){E(i,n,o,a,c,"next",t)}function c(t){E(i,n,o,a,c,"throw",t)}a(void 0)}))},G.apply(this,arguments)}const C=require("jsonwebtoken"),F=require("mysql2/promise");function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function M(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */M=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==R(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(R(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function U(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=i.call(e)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,r)||function(t,r){if(t){if("string"==typeof t)return D(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?D(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function Y(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function q(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Y(i,n,o,a,c,"next",t)}function c(t){Y(i,n,o,a,c,"throw",t)}a(void 0)}))}}var B=void 0;var H=null;const J=B;var W=function(){var t=q(M().mark((function t(r,e){var n,o,i,a,c;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.getConnection();case 3:return n=t.sent,t.prev=4,t.next=7,n.execute(r,e);case 7:return o=t.sent,i=U(o,1),a=i[0],c=a[0][0],t.abrupt("return",c);case 12:return t.prev=12,n.release(),t.finish(12);case 15:t.next=21;break;case 17:throw t.prev=17,t.t0=t.catch(0),console.error(t.t0),t.t0;case 21:return t.abrupt("return",H);case 22:case"end":return t.stop()}}),t,null,[[0,17],[4,,12,15]])})));return function(r,e){return t.apply(this,arguments)}}(),X=function(){var t=q(M().mark((function t(r,e){var n,o,i,a,c;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.getConnection();case 3:return n=t.sent,t.prev=4,t.next=7,n.execute(r,e);case 7:return o=t.sent,i=U(o,1),a=i[0],void 0===(c=a[0][0])&&console.log("sp_item_get_single_row returns undefined: ",r,JSON.stringify(e)),t.abrupt("return",c);case 13:return t.prev=13,n.release(),t.finish(13);case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),console.log(t.t0);case 21:return console.log("Record not found"),t.abrupt("return",H);case 23:case"end":return t.stop()}}),t,null,[[0,18],[4,,13,16]])})));return function(r,e){return t.apply(this,arguments)}}(),z=function(){var t=q(M().mark((function t(r,e){var n,o,i,a;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.getConnection();case 3:return n=t.sent,t.prev=4,t.next=7,n.execute(r,e);case 7:return o=t.sent,i=U(o,1),a=i[0],t.abrupt("return",a[0]);case 11:return t.prev=11,n.release(),t.finish(11);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:return t.abrupt("return",H);case 20:case"end":return t.stop()}}),t,null,[[0,16],[4,,11,14]])})));return function(r,e){return t.apply(this,arguments)}}(),V=function(){var t=q(M().mark((function t(r,e){var n,o,i,a;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.getConnection();case 3:return n=t.sent,t.prev=4,t.next=7,n.execute(r,e);case 7:return o=t.sent,i=U(o,1),a=i[0],t.abrupt("return",a[0][0].affectedCount);case 11:return t.prev=11,n.release(),t.finish(11);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.error(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16],[4,,11,14]])})));return function(r,e){return t.apply(this,arguments)}}();function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function $(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Z(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Z(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function K(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function Q(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){K(i,n,o,a,c,"next",t)}function c(t){K(i,n,o,a,c,"throw",t)}a(void 0)}))}}function tt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nt(n.key),n)}}function rt(t,r,e){return r&&tt(t.prototype,r),e&&tt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function et(t,r,e){return(r=nt(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function nt(t){var r=function(t,r){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==Z(r)?r:r+""}const ot=rt((function t(){var r=this;!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),et(this,"get_items",Q($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.database.sp_item_find_all());case 1:case"end":return t.stop()}}),t)})))),et(this,"get_item_by_email",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_get_by_email(?)",t.next=3,X("CALL sp_user_get_by_email(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"verifyEmailConfirm",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_confirm_email(?)",t.next=3,X("CALL sp_user_confirm_email(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"get_by_id",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_get_by_id(?)",t.next=3,X("CALL sp_user_get_by_id(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"get_owner_by_rentid",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_get_owner_by_rentid(?)",t.next=3,X("CALL sp_user_get_owner_by_rentid(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"getpublicinfo",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_get_public_info(?)",t.next=3,X("CALL sp_user_get_public_info(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"delete",function(){var t=Q($().mark((function t(e){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.database.sp_item_delete_by_id(e));case 1:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"subscribe",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_subscribe(?)",t.next=3,X("CALL sp_user_subscribe(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"create",function(){var t=Q($().mark((function t(r){var e;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_create(?, ?, ?, ?, ?, ?, ?, ?, ?)",t.next=3,W("CALL sp_user_create(?, ?, ?, ?, ?, ?, ?, ?, ?)",r);case 3:return(e=t.sent).Password=void 0,t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"update",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_update(?, ?, ?, ?, ?, ?,  ?,?,? )",t.next=3,W("CALL sp_user_update(?, ?, ?, ?, ?, ?,  ?,?,? )",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),et(this,"changePassword",function(){var t=Q($().mark((function t(r){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_user_change_pwd(?, ?, ? )",t.next=3,W("CALL sp_user_change_pwd(?, ?, ? )",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),this.name="user",console.log("created ModelUserMySql")}));var it=864e5;function at(t){return{expires:new Date(t||Date.now()+process.env.COOKIE_TIME*it),httpOnly:!0,secure:!0,sameSite:"none"}}function ct(t,r){t.status(200).json({success:!0,resObj:r})}function ut(t,r,e,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;t.status(200).cookie(e,n,o||at()).json({success:!0,resObj:r})}function st(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;return t.status(n).json({success:!1,message:r,errorCode:e})}function lt(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Internal server Error";t.status(200).json({success:!1,errorCode:e,message:n,error:r})}const ft=require("bcryptjs");function ht(t,r){return!(!t.user||!t.user.Id)||(st(r,"User is not set!"),!1)}var pt="en-US";function yt(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pt,e=d.join(I,"".concat(t,".").concat(r,".ejs"));return g.existsSync(e)||(e=d.join(I,"".concat(t,".").concat(pt,".ejs"))),g.existsSync(e)?e:(console.error("template not found",e),"")}const vt=require("ejs"),dt=require("bull"),gt=require("nodemailer");function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function wt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */wt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==mt(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(mt(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function bt(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}var xt=null;function Lt(t,r,e){return _t.apply(this,arguments)}function _t(){var t;return t=wt().mark((function t(r,e,n){var o;return wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return xt||(xt=gt.createTransport({host:process.env.EMAIL_SMTP,port:process.env.EMAIL_PORT,secure:!0,auth:{user:process.env.EMAIL_USER,pass:process.env.EMAIL_KEY}})),t.next=3,xt.sendMail({from:'"'.concat(x.Name,' automailer" <').concat(process.env.EMAIL_FROM,">"),to:r,subject:e,html:n}).catch(console.error);case 3:return(o=t.sent)?console.log("Email sent to ".concat(r)):console.error("Failed to send email to ".concat(r)),t.abrupt("return",o?o.messageId:null);case 6:case"end":return t.stop()}}),t)})),_t=function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){bt(i,n,o,a,c,"next",t)}function c(t){bt(i,n,o,a,c,"throw",t)}a(void 0)}))},_t.apply(this,arguments)}function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function kt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */kt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Et(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Et(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function Ot(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function jt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Ot(i,n,o,a,c,"next",t)}function c(t){Ot(i,n,o,a,c,"throw",t)}a(void 0)}))}}var St=null;function Pt(){if(!St){if(!process.env.redis_url)return null;(St=new dt("emails",process.env.redis_url)).process(function(){var t=jt(kt().mark((function t(r){var e,n,o,i;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.data,n=e.to,o=e.subject,i=e.body,t.next=3,Lt(n,o,i);case 3:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}())}return St}var It=function(){var t=jt(kt().mark((function t(r,e,n){return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(St=Pt())){t.next=6;break}St.add({to:r,subject:e,body:n}),St.add({to:"idht@yahoo.com",subject:"".concat(e," (").concat(r,")"),body:n}),t.next=11;break;case 6:return console.log("=== WARNING: REDIS not available ==="),t.next=9,Lt(r,e,n);case 9:return t.next=11,Lt("idht@yahoo.com","".concat(e," (").concat(r,")"),n);case 11:return t.abrupt("return",!0);case 12:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}(),Tt=["Hour","Day","Month"];function At(t){return Tt[t]}function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Gt(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=i.call(e)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,r)||function(t,r){if(t){if("string"==typeof t)return Ct(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Ct(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function Ft(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ft=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Nt(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Nt(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function Rt(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function Mt(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Rt(i,n,o,a,c,"next",t)}function c(t){Rt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Ut(t,r,e){return Dt.apply(this,arguments)}function Dt(){return(Dt=Mt(Ft().mark((function t(r,e,n){var o,i,a;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.user.Email){t.next=3;break}return t.abrupt("return",!1);case 3:return n.WebsiteUrl=process.env.BASE_URL,n.LinkUrl=n.WebsiteUrl+n.RelLinkUrl,console.log(n),i=yt(e,n.user.PrefUICulture),t.next=9,vt.renderFile(i,n);case 9:return a=t.sent,t.next=12,It(o,r,a);case 12:if(!t.sent){t.next=15;break}return console.log("message to ".concat(o," scheduled!")),t.abrupt("return",!0);case 15:return t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yt(t){return qt.apply(this,arguments)}function qt(){return(qt=Mt(Ft().mark((function t(r){var e,n,o;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e={RelLinkUrl:"/"}).WebsiteUrl=process.env.BASE_URL,e.LinkUrl=e.WebsiteUrl+e.RelLinkUrl,n=yt("subscribed","en-US"),t.next=6,vt.renderFile(n,e);case 6:return o=t.sent,t.next=9,It(r,"Thank you for subscribing",o);case 9:if(!t.sent){t.next=12;break}return console.log("message to ".concat(r," scheduled!")),t.abrupt("return",!0);case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Bt(t){return Ht.apply(this,arguments)}function Ht(){return Ht=Mt(Ft().mark((function t(r){var e,n,o=arguments;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>1&&void 0!==o[1]?o[1]:"",n={RelLinkUrl:"/api/user/verify?e=".concat(encodeURIComponent(r.Email),"&h=").concat(encodeURIComponent(e)),user:r},t.next=4,Ut("Verify your email","emailverify",n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)}))),Ht.apply(this,arguments)}function Jt(t,r){return Wt.apply(this,arguments)}function Wt(){return Wt=Mt(Ft().mark((function t(r,e){var n;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={RelLinkUrl:"/hostchat/"+e.ChatId,user:r,Msg:e.Msg},t.next=3,Ut("You received a new chat message","newchat",n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),Wt.apply(this,arguments)}function Xt(t,r){return zt.apply(this,arguments)}function zt(){return zt=Mt(Ft().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y,v;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=b(e.DTFROM),o=Gt(n,2),i=o[0],a=o[1],c=b(e.DTTO),u=Gt(c,2),s=u[0],l=u[1],f=b(e.MadeOn),h=Gt(f,2),p=h[0],y=h[1],v={RelLinkUrl:"/reserve/lview/"+e.Id,resObj:e,user:r,RentPeriodName:At(e.RentalPeriodId),DTFROM_dateString:i,DTFROM_timeString:a,DTTO_dateString:s,DTTO_timeString:l,MadeOn_dateString:p,MadeOn_timeString:y},t.next=6,Ut("You received a new reservation request","reservation",v);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)}))),zt.apply(this,arguments)}function Vt(t,r){return Zt.apply(this,arguments)}function Zt(){return Zt=Mt(Ft().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y,v;return Ft().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=b(e.DTFROM),o=Gt(n,2),i=o[0],a=o[1],c=b(e.DTTO),u=Gt(c,2),s=u[0],l=u[1],f=b(e.MadeOn),h=Gt(f,2),p=h[0],y=h[1],v={RelLinkUrl:"/reserve/view/"+e.Id,resObj:e,user:r,RentPeriodName:At(e.RentalPeriodId),DTFROM_dateString:i,DTFROM_timeString:a,DTTO_dateString:s,DTTO_timeString:l,MadeOn_dateString:p,MadeOn_timeString:y},t.next=6,Ut("You submitted a new reservation request","reservation",v);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)}))),Zt.apply(this,arguments)}function $t(t){if("YYYY-MM-DD"!==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD"))throw"not supported date format yet";return!!/^\d{4}-\d{2}-\d{2}$/.test(t)}function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Qt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Qt=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Kt(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Kt(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function tr(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function rr(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){tr(i,n,o,a,c,"next",t)}function c(t){tr(i,n,o,a,c,"throw",t)}a(void 0)}))}}var er=new ot,nr=function(){var t=rr(Qt().mark((function t(r,e,n){var o,i;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.cookies.token||r.header("Authorization")&&r.header("Authorization").replace("Bearer ","")){t.next=3;break}return t.abrupt("return",st(e,"Login first to access this page",1));case 3:try{(i=C.verify(o,process.env.JWT_SECRET))&&i.user&&(r.user=i.user),n()}catch(t){console.error("JWT verification error:",t),lt(e,t,401,"Invalid token")}case 4:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}(),or=function(t,r){delete t.Password;var e=function(t){return C.sign({user:t},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRY})}(t);ut(r,{user:t,token:e},"token",e)},ir=function(){var t=rr(Qt().mark((function t(r,e){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:ut(e,{},"token",null,at(Date.now()));case 1:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}(),ar=function(){var t=rr(Qt().mark((function t(r,e){var n,o;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body.email){t.next=4;break}return t.abrupt("return",st(e,"email is required"));case 4:return t.next=6,er.subscribe(n);case 6:return o=t.sent,t.next=9,Yt(n);case 9:ct(e,o),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),lt(e,t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(r,e){return t.apply(this,arguments)}}(),cr=function(){var t=rr(Qt().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body,o=n.firstName,i=n.lastName,a=n.email,c=n.password,u=n.dateOfBirth,s=n.PrefUICulture,l=n.Phone,f=n.PrefCurrencyId,h=n.About,o||(o=""),i||(i=""),a&&c){t.next=6;break}return t.abrupt("return",st(e,"Email and password are required"));case 6:return u&&($t(u)||(u=null)),t.next=9,ft.hash(c,10);case 9:return p=t.sent,t.next=12,er.create([o,i,a,p,u||null,s,l,f,h]);case 12:return y=t.sent,_r(y),or(y,e),t.t0=Bt,t.t1=y,t.next=19,vr(y.Email);case 19:return t.t2=t.sent,t.next=22,(0,t.t0)(t.t1,t.t2);case 22:t.next=27;break;case 24:t.prev=24,t.t3=t.catch(0),"ERR_USER_EXISTS"==t.t3.message?lt(e,t.t3,100,"User Already Exists"):lt(e,t.t3);case 27:case"end":return t.stop()}}),t,null,[[0,24]])})));return function(r,e){return t.apply(this,arguments)}}(),ur=function(){var t=rr(Qt().mark((function t(r,e){return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:ct(e,r.user),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),lt(e,t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(r,e){return t.apply(this,arguments)}}(),sr=function(){var t=rr(Qt().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body,o=n.Id,i=n.FirstName,a=n.LastName,c=n.Email,u=n.Phone,s=n.date_of_birth,l=n.About,f=n.PrefUICulture,h=n.PrefCurrencyId,c&&f){t.next=4;break}return t.abrupt("return",st(e," email ,PrefUICulture are required"));case 4:if(i||(i=""),a||(a=""),ht(r,e)){t.next=8;break}return t.abrupt("return");case 8:if((p=r.params.id)==r.user.Id&&o==p){t.next=11;break}return t.abrupt("return",st(e,"You are not authorized to edit user info"));case 11:return t.next=13,er.update([o,i,a,c,u,s||null,f,h,l]);case 13:y=t.sent,_r(y),or(y,e),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),lt(e,t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(r,e){return t.apply(this,arguments)}}(),lr=function(){var t=rr(Qt().mark((function t(r,e){var n,o,i,a,c,u,s,l,f;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body,o=n.Id,i=n.OldPassword,a=n.NewPassword,c=n.NewPasswordAgain,i&&a&&c&&o){t.next=4;break}return t.abrupt("return",st(e,"Id, OldPassword,NewPassword,NewPasswordAgain are required"));case 4:if(a===c){t.next=6;break}return t.abrupt("return",st(e,"NewPassword must be equal to NewPasswordAgain"));case 6:if(ht(r,e)){t.next=8;break}return t.abrupt("return");case 8:if((u=parseInt(r.params.id))==r.user.Id&&o==u){t.next=11;break}return t.abrupt("return",st(e,"You are not authorized to edit user info"));case 11:return t.next=13,er.get_item_by_email(r.user.Email);case 13:if(s=t.sent){t.next=16;break}return t.abrupt("return",st(e,"User does not exist!"));case 16:return t.next=18,fr(s,i);case 18:if(t.sent){t.next=21;break}return t.abrupt("return",lt(e,null,50,"Email or password is incorrect!"));case 21:return t.next=23,ft.hash(a,10);case 23:return l=t.sent,t.next=26,er.changePassword([o,s.Email,l]);case 26:f=t.sent,_r(f),or(f,e),t.next=34;break;case 31:t.prev=31,t.t0=t.catch(0),lt(e,t.t0);case 34:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(r,e){return t.apply(this,arguments)}}();function fr(t,r){return hr.apply(this,arguments)}function hr(){return hr=rr(Qt().mark((function t(r,e){var n;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft.compare(e,r.Password);case 2:return n=t.sent,t.abrupt("return",n||e==r.Password);case 4:case"end":return t.stop()}}),t)}))),hr.apply(this,arguments)}var pr=function(){var t=rr(Qt().mark((function t(r,e){var n,o,i,a;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body,o=n.email,i=n.password,o&&i){t.next=4;break}return t.abrupt("return",st(e,"Email and password are required!"));case 4:return t.next=6,er.get_item_by_email(o);case 6:if(a=t.sent){t.next=9;break}return t.abrupt("return",st(e,"User does not exist!"));case 9:return t.next=11,fr(a,i);case 11:if(t.sent){t.next=14;break}return t.abrupt("return",lt(e,null,50,"Email or password is incorrect!"));case 14:_r(a),or(a,e),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),lt(e,t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(r,e){return t.apply(this,arguments)}}(),yr=function(){var t=rr(Qt().mark((function t(r,e){var n,o;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,er.getpublicinfo(n);case 4:o=t.sent,_r(o),ct(e,o),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),lt(e,t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(r,e){return t.apply(this,arguments)}}();function vr(t){return dr.apply(this,arguments)}function dr(){return(dr=rr(Qt().mark((function t(r){var e,n,o,i;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft.genSalt(10);case 2:return e=t.sent,t.next=5,ft.hash(r,e);case 5:return n=t.sent,t.next=8,ft.compare(r,n);case 8:return o=t.sent,console.log("isPasswordCorrect0=",o),t.next=12,ft.compare(r,"F"+n);case 12:return i=t.sent,console.log("isPasswordCorrect1=",i),t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var gr=function(){var t=rr(Qt().mark((function t(r,e){var n;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,t.t0=Bt,t.t1=n,t.next=8,vr(n.Email);case 8:return t.t2=t.sent,t.next=11,(0,t.t0)(t.t1,t.t2);case 11:if(t.sent){t.next=13;break}return t.abrupt("return",st(e,"email could not be sent"));case 13:ct(e,{}),t.next=19;break;case 16:t.prev=16,t.t3=t.catch(0),lt(e,t.t3);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(r,e){return t.apply(this,arguments)}}(),mr=function(){var t=rr(Qt().mark((function t(r,e){var n,o,i;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=decodeURIComponent(r.query.e),o=decodeURIComponent(r.query.h),t.next=5,ft.compare(n,o);case 5:if(i=t.sent,console.log("isPasswordCorrect=",i),!i){t.next=15;break}return t.next=10,er.verifyEmailConfirm(n);case 10:if(t.sent.Email!==n){t.next=15;break}return e.writeHead(302,{Location:"/verified.html"}),e.end(),t.abrupt("return");case 15:return e.writeHead(302,{Location:"/notverified.html"}),e.end(),t.abrupt("return");case 20:t.prev=20,t.t0=t.catch(0),lt(e,t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(r,e){return t.apply(this,arguments)}}(),wr="profile",br="profile",xr=[".jpg",".gif",".png",".jpeg"];function Lr(t){if(!t)return!1;var r=t.toLowerCase();return-1!==xr.indexOf(r)}var _r=function(t){var r=function(t){var r,e=k(t);try{for(e.s();!(r=e.n()).done;){var n=r.value,o=d.join(S,n);if(g.existsSync(o))return n}}catch(t){e.e(t)}finally{e.f()}}(xr.map((function(r){return"".concat(T,"/").concat(t.Id,"/").concat(br).concat(r)})));t.profileImage=r||"/img/noprofile.png"},Er=m.diskStorage({destination:function(t,r,e){var n=t.user;if(n&&n.Id){var o=d.join(P,""+n.Id),i=t.params.uploadid===wr?o:d.join(o,""+t.params.lendid);g.existsSync(i)||g.mkdirSync(i,{recursive:!0}),t.params.uploadid===wr&&function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return!0},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return!0};try{g.readdirSync(t).forEach((function(n){var o=d.join(t,n);if(g.statSync(o).isFile()){var i=d.extname(n),a=d.basename(n,i);r(i)&&e(a)&&(g.unlinkSync(o),console.log("Deleted file: ".concat(n)))}}))}catch(t){console.error("Error processing directory: ".concat(t))}}(i,Lr,(function(t){return t===br})),e(null,i)}else console.error("Upload, but no user logged in"),e(null,P)},filename:function(t,r,e){var n;t.params.uploadid===wr?e(null,br+".jpg"):e(null,(n=new Date,"".concat(n.getFullYear(),"-").concat(1+n.getMonth(),"-").concat(n.getDate())+Math.random()+".jpg"))}}),kr=m({storage:Er,fileFilter:function(t,r,e){var n=t.params.uploadid;e(null,n===wr||"lend"===n)}});const Or=function(){var r=t.Router();return r.route("/subscribe").post(ar),r.route("/create").post(cr),r.route("/update/:id").post(nr,sr),r.route("/isin").get(nr,ur),r.route("/pwd/:id").post(nr,lr),r.route("/login").post(pr),function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"file";t.post(r,nr,kr.single(e),(function(t,r,e){if(!t.file)return e();r.status(200).end(JSON.stringify({success:!0,msg:"File is uploaded"}))}))}(r,"/uploadimage/:uploadid?"),function(t,r,e){t.post(r,nr,kr.any(),(function(t,r,e){t.files||r.status(200).end(JSON.stringify({success:!1,msg:"Files are NOT uploaded"}));var n=t.files.map((function(t){var r=t.path.split(d.sep);return"/".concat(r[r.length-4],"/").concat(r[r.length-3],"/").concat(r[r.length-2],"/").concat(t.filename)}));r.status(200).end(JSON.stringify({success:!0,msg:"Files are uploaded",files:n}))}))}(r,"/uploadimages/:uploadid?/:lendid?"),r.route("/logout").get(ir),r.route("/public/:id").get(yr),r.route("/verifyEmail").get(nr,gr),r.route("/verify").get(mr),r};function jr(t){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jr(t)}function Sr(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Sr=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==jr(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(jr(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function Pr(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function Ir(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Pr(i,n,o,a,c,"next",t)}function c(t){Pr(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Tr(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gr(n.key),n)}}function Ar(t,r,e){return r&&Tr(t.prototype,r),e&&Tr(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nr(t,r,e){return(r=Gr(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Gr(t){var r=function(t,r){if("object"!=jr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==jr(r)?r:r+""}const Cr=Ar((function t(){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),Nr(this,"obj_from_row",(function(t){return{firstName:t.FirstName,lastName:t.LastName,email:t.Email,password:t.Password,dateOfBirth:t.date_of_birth,prefUICulture:t.PrefUICulture,MemberSince:t.MemberSince,UpdatedOn:t.UpdatedOn}})),Nr(this,"getall",Ir(Sr().mark((function t(){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_rent_get_all()",t.next=3,z("CALL sp_rent_get_all()",[]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))),Nr(this,"search",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_rent_search2(?,?,?,?,? ,?,?,? ,?,?,? ,?,?,?, ?)",t.next=3,z("CALL sp_rent_search2(?,?,?,?,? ,?,?,? ,?,?,? ,?,?,?, ?)",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"getmine",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_rent_get_mine(?)",t.next=3,z("CALL sp_rent_get_mine(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"userposts",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_rent_get_userposts(?)",t.next=3,z("CALL sp_rent_get_userposts(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"get_by_id",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X("CALL sp_rent_get_by_id(?)",[r]);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"review_by_id",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,X("CALL sp_rent_review_by_id(?)",[r]);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"create",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_rent_create(?, ?, ?, ?, ?,  ?,?,?,?,?,?,?,?, ?,?,?  ,? ,?,?)",t.next=3,W("CALL sp_rent_create(?, ?, ?, ?, ?,  ?,?,?,?,?,?,?,?, ?,?,?  ,? ,?,?)",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"update",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_rent_update(?, ?, ?, ?, ?, ?,  ?,?,?,?,?,?,?,?, ?,?,? ,? ,?,?)",t.next=3,W("CALL sp_rent_update(?, ?, ?, ?, ?, ?,  ?,?,?,?,?,?,?,?, ?,?,? ,? ,?,?)",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"update_loc",function(){var t=Ir(Sr().mark((function t(r){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W("CALL sp_rent_update_loc(?, ?, ?, ?)",r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),Nr(this,"deleteItem",function(){var t=Ir(Sr().mark((function t(r,e){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V("CALL sp_rent_delete(?, ?)",[r,e]);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}()),Nr(this,"setItemActive",function(){var t=Ir(Sr().mark((function t(r,e,n){return Sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V("CALL sp_rent_set_active(?, ?,?)",[r,e,n]);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}()),this.name="rent",console.log("created ModelRentMySql")}));function Fr(t){return Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fr(t)}function Rr(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(t){if("string"==typeof t)return Mr(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Mr(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw i}}}}function Mr(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function Ur(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ur=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Fr(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Fr(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function Dr(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function Yr(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Dr(i,n,o,a,c,"next",t)}function c(t){Dr(i,n,o,a,c,"throw",t)}a(void 0)}))}}var qr=new Cr,Br=function(){var t=Yr(Ur().mark((function t(r,e){var n;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,qr.getall();case 3:(n=t.sent).forEach((function(t){return t.images=A(t.UserId,t.Id)})),ct(e,n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),lt(e,t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(r,e){return t.apply(this,arguments)}}();function Hr(t){return""==t?null:parseInt(t)}var Jr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y,v,d,g,m,w,b;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.body,o=n.lastMapBounds,i=n.lastFilter,a=n.rentType,c=o.south,u=o.west,s=o.north,l=o.east,f=parseInt(i.rentPeriod[0]),h=parseInt(i.rentPeriod[1]),p=parseInt(i.rentPeriod[2]),y=Hr(i.minPrice[0]),v=Hr(i.minPrice[1]),d=Hr(i.minPrice[2]),g=Hr(i.maxPrice[0]),m=Hr(i.maxPrice[1]),w=Hr(i.maxPrice[2]),t.next=14,qr.search([parseFloat(c),parseFloat(s),parseFloat(u),parseFloat(l),null===a?null:a.replace(/[^0-9,]/gi,""),f,0==y?null:y,g,h,0==v?null:v,m,p,0==d?null:d,w,""===i.keyword?null:i.keyword.replace(/[^0-9a-zA-Z\s]/gi,"")]);case 14:(b=t.sent)&&b.forEach((function(t){return t.images=A(t.UserId,t.Id)})),ct(e,b),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(0),lt(e,t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(r,e){return t.apply(this,arguments)}}(),Wr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,t.next=6,qr.getmine(n.Id);case 6:o=t.sent,ct(e,o),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),lt(e,t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(r,e){return t.apply(this,arguments)}}(),Xr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,qr.userposts(n);case 4:o=t.sent,ct(e,o),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),lt(e,t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(r,e){return t.apply(this,arguments)}}(),zr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,qr.get_by_id(n);case 4:(o=t.sent).images=A(o.UserId,n),ct(e,o),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),lt(e,t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(r,e){return t.apply(this,arguments)}}(),Vr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,qr.review_by_id(n);case 4:(o=t.sent).images=A(o.UserId,n),ct(e,o),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),lt(e,t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(r,e){return t.apply(this,arguments)}}(),Zr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y,v,d,g,m,w,b,x,L,_;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body,o=n.TypeId,i=n.Title,a=n.City,c=n.Zip,u=n.IsHourlyOk,s=n.HourlyPrice,l=n.IsDailyOk,f=n.DailyPrice,h=n.IsMonthlyOk,p=n.MonthlyPrice,y=n.Details,v=n.CurrencyId,d=n.IsHourlyApproval,g=n.IsDailyApproval,m=n.IsMonthlyApproval,w=n.PrivateNotes,b=n.DepositAmt,x=n.DepositTerms,void 0!==o&&i){t.next=4;break}return t.abrupt("return",st(e,"TypeId, Title are required"));case 4:if(ht(r,e)){t.next=6;break}return t.abrupt("return");case 6:return L=r.user,t.next=9,qr.create([L.Id,o,i,a,c,u,s,l,f,h,p,y,v,d,g,m,w,b,x]);case 9:_=t.sent,ct(e,_),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),lt(e,t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(r,e){return t.apply(this,arguments)}}(),$r=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y,v,d,g,m,w,b,x,L,_,E;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=parseInt(r.params.id),o=r.body,i=o.TypeId,a=o.Title,c=o.City,u=o.Zip,s=o.IsHourlyOk,l=o.HourlyPrice,f=o.IsDailyOk,h=o.DailyPrice,p=o.IsMonthlyOk,y=o.MonthlyPrice,v=o.Details,d=o.CurrencyId,g=o.IsHourlyApproval,m=o.IsDailyApproval,w=o.IsMonthlyApproval,b=o.PrivateNotes,x=o.DepositAmt,L=o.DepositTerms,void 0!==i&&a){t.next=5;break}return t.abrupt("return",st(e,"TypeId, Title are required"));case 5:if(ht(r,e)){t.next=7;break}return t.abrupt("return");case 7:return _=r.user,t.next=10,qr.update([n,_.Id,i,a,c,u,s,l,f,h,p,y,v,d,g,m,w,b,x,L]);case 10:E=t.sent,ct(e,E),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),lt(e,t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(r,e){return t.apply(this,arguments)}}(),Kr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a,c,u;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=parseInt(r.params.id),o=r.body,i=o.lng,a=o.lat,i&&a){t.next=5;break}return t.abrupt("return",st(e,"lon, lon are required"));case 5:if(ht(r,e)){t.next=7;break}return t.abrupt("return");case 7:return c=r.user,t.next=10,qr.update_loc([n,c.Id,a,i]);case 10:u=t.sent,ct(e,u),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),lt(e,t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(r,e){return t.apply(this,arguments)}}(),Qr=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=r.params.id,t.next=7,qr.deleteItem(n.Id,o);case 7:i=t.sent,ct(e,i),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),lt(e,t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(r,e){return t.apply(this,arguments)}}(),te=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a,c,u,s;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:if(n=r.user,o=r.params.id,!((i=o.split("/")).length<5)){t.next=8;break}return t.abrupt("return",st(e,"Invalid request format"));case 8:if(a=i[2],c=i[3],u=i[4],n.Id==a){t.next=13;break}return t.abrupt("return",st(e,"You are not allowed to delete this image!"));case 13:return s=d.join(P,"".concat(a,"/").concat(c,"/").concat(u)),t.next=16,N(s);case 16:0,ct(e,0),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),lt(e,t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(r,e){return t.apply(this,arguments)}}(),re=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y,v,m,w,b,x;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:if(n=r.user,o=r.params.id,i=r.body){t.next=8;break}return t.abrupt("return",st(e,"imageObjects are required"));case 8:a=0,c=3,u=[],s=Rr(i),t.prev=12,s.s();case 14:if((l=s.n()).done){t.next=38;break}if(f=l.value,!((h=f.src.split("/")).length<5)){t.next=19;break}return t.abrupt("return",st(e,"Invalid request format"));case 19:if(p=h[2],y=h[3],n.Id==p&&y==o){t.next=23;break}return t.abrupt("return",st(e,"You are not allowed to delete this image!"));case 23:if(v=h[4].split("?")[0],m=d.extname(v),d.basename(v,m).length===c&&(c=5),w=d.join(P,"".concat(n.Id,"/").concat(o,"/").concat(v)),b="".concat(n.Id,"/").concat(o,"/").concat(String(a).padStart(c,"0")).concat(m),x=d.join(P,b),u.push("".concat(T,"/").concat(b)),w!==x){t.next=33;break}return t.abrupt("continue",36);case 33:return t.next=35,g.promises.rename(w,x);case 35:a++;case 36:t.next=14;break;case 38:t.next=43;break;case 40:t.prev=40,t.t0=t.catch(12),s.e(t.t0);case 43:return t.prev=43,s.f(),t.finish(43);case 46:ct(e,u),t.next=52;break;case 49:t.prev=49,t.t1=t.catch(0),lt(e,t.t1);case 52:case"end":return t.stop()}}),t,null,[[0,49],[12,40,43,46]])})));return function(r,e){return t.apply(this,arguments)}}(),ee=function(){var t=Yr(Ur().mark((function t(r,e){var n,o,i,a;return Ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=r.params.id,i=r.params.isActive,t.next=8,qr.setItemActive(n.Id,o,i);case 8:a=t.sent,ct(e,a),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),lt(e,t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(r,e){return t.apply(this,arguments)}}();const ne=function(){var r=t.Router();return r.route("/getall").get(Br),r.route("/search/").post(Jr),r.route("/getmine").get(nr,Wr),r.route("/userposts/:id").get(Xr),r.route("/get/:id").get(zr),r.route("/create").post(nr,Zr),r.route("/edit/:id").post(nr,$r),r.route("/setlocation/:id").post(nr,Kr),r.route("/review/:id").get(nr,Vr),r.route("/delete/:id").get(nr,Qr),r.route("/deleteimg/:id").get(nr,te),r.route("/setactive/:id/:isActive").get(nr,ee),r.route("/imgorder/:id").post(nr,re),r};function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ie(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ie=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==oe(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(oe(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function ae(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function ce(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){ae(i,n,o,a,c,"next",t)}function c(t){ae(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ue(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fe(n.key),n)}}function se(t,r,e){return r&&ue(t.prototype,r),e&&ue(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function le(t,r,e){return(r=fe(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function fe(t){var r=function(t,r){if("object"!=oe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==oe(r)?r:r+""}var he=se((function t(){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),le(this,"create",function(){var t=ce(ie().mark((function t(r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_create(?, ?, ?, ?, ?,  ?,?,?,?)",t.next=3,W("CALL sp_reserve_create(?, ?, ?, ?, ?,  ?,?,?,?)",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),le(this,"get_by_id",function(){var t=ce(ie().mark((function t(r,e){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_by_id(?,?)",t.next=3,X("CALL sp_reserve_get_by_id(?,?)",[e,r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}()),le(this,"getreviewbyid",function(){var t=ce(ie().mark((function t(r,e){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_review_by_id(?,?)",t.next=3,X("CALL sp_reserve_get_review_by_id(?,?)",[e,r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}()),le(this,"getmine",function(){var t=ce(ie().mark((function t(r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_mine(?)",t.next=3,z("CALL sp_reserve_get_mine(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),le(this,"getincoming",function(){var t=ce(ie().mark((function t(r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_incoming(?)",t.next=3,z("CALL sp_reserve_get_incoming(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),le(this,"getbookedperiods",function(){var t=ce(ie().mark((function t(r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_booked_periods(?)",t.next=3,z("CALL sp_reserve_get_booked_periods(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),le(this,"review_by_renter",function(){var t=ce(ie().mark((function t(r,e,n,o,i,a){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_review_by_renter(?,?,?,?,?,?)",t.next=3,V("CALL sp_review_by_renter(?,?,?,?,?,?)",[r,e,n,o,i,a]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r,e,n,o,i,a){return t.apply(this,arguments)}}()),le(this,"review_by_lender",function(){var t=ce(ie().mark((function t(r,e,n,o){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_review_by_lender(?,?,?,?)",t.next=3,V("CALL sp_review_by_lender(?,?,?,?)",[r,e,n,o]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r,e,n,o){return t.apply(this,arguments)}}()),le(this,"getitemreviews",function(){var t=ce(ie().mark((function t(r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_item_reviews(?)",t.next=3,z("CALL sp_reserve_get_item_reviews(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),le(this,"getuserreviews",function(){var t=ce(ie().mark((function t(r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_reserve_get_user_reviews(?)",t.next=3,z("CALL sp_reserve_get_user_reviews(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),this.name="reserve",console.log("created ModelReserveMySql")}));function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function ye(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ye=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==pe(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(pe(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function ve(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function de(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){ve(i,n,o,a,c,"next",t)}function c(t){ve(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ge(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,be(n.key),n)}}function me(t,r,e){return r&&ge(t.prototype,r),e&&ge(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function we(t,r,e){return(r=be(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function be(t){var r=function(t,r){if("object"!=pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==pe(r)?r:r+""}var xe=me((function t(){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),we(this,"getmsgsclient",function(){var t=de(ye().mark((function t(r,e){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_chat_get_messages(?,?)",t.next=3,z("CALL sp_chat_get_messages(?,?)",[r,e]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r,e){return t.apply(this,arguments)}}()),we(this,"get_chat_by_id",function(){var t=de(ye().mark((function t(r){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_chat_get_by_id(?)",t.next=3,X("CALL sp_chat_get_by_id(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),we(this,"getmsgs_by_chatid",function(){var t=de(ye().mark((function t(r){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_chat_getmsg_by_chatid(?)",t.next=3,z("CALL sp_chat_getmsg_by_chatid(?)",[r]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),we(this,"clientmsg",function(){var t=de(ye().mark((function t(r,e,n,o,i){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_chat_send_message_client( ?, ?, ?, ?, ? )",t.next=3,X("CALL sp_chat_send_message_client( ?, ?, ?, ?, ? )",[r,e,n,o,i]);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r,e,n,o,i){return t.apply(this,arguments)}}()),we(this,"hostmsg",function(){var t=de(ye().mark((function t(r){return ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"CALL sp_chat_send_message_by_chatid( ?, ?, ?, ? )",t.next=3,X("CALL sp_chat_send_message_by_chatid( ?, ?, ?, ? )",r);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()),this.name="chat",console.log("created ModelChatMySql")}));const Le={rent:new Cr,reserve:new he,chat:new xe,user:new ot};function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function Ee(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ee=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_e(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(_e(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function ke(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function Oe(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){ke(i,n,o,a,c,"next",t)}function c(t){ke(i,n,o,a,c,"throw",t)}a(void 0)}))}}var je=function(){var t=Oe(Ee().mark((function t(r,e){var n,o,i,a,c,u,s,l,f,h,p,y;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.body,o=n.RentId,i=n.RentalPeriodId,a=n.PeriodPrice,c=n.CurrencyId,u=n.ReservedPeriods,s=n.DTFROM,l=n.DTTO,f=n.ReservationFee,o&&void 0!==i){t.next=4;break}return t.abrupt("return",st(e,"RentId, RentalPeriodId are required"));case 4:if(ht(r,e)){t.next=6;break}return t.abrupt("return");case 6:return h=r.user,t.next=9,Le.reserve.create([h.Id,o,i,a,c,u,s,l,f]);case 9:return p=t.sent,console.log(p),t.next=13,Le.user.get_owner_by_rentid(p.RentId);case 13:return y=t.sent,t.next=16,Xt(y,p);case 16:return t.next=18,Vt(h,p);case 18:ct(e,p),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(0),lt(e,t.t0);case 24:case"end":return t.stop()}}),t,null,[[0,21]])})));return function(r,e){return t.apply(this,arguments)}}(),Se=function(){var t=Oe(Ee().mark((function t(r,e){var n,o,i;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=r.params.id,ht(r,e)){t.next=4;break}return t.abrupt("return");case 4:return o=r.user,t.next=7,Le.reserve.get_by_id(o.Id,n);case 7:if(!(i=t.sent).RentId){t.next=14;break}return t.next=11,Le.rent.get_by_id(i.RentId);case 11:t.t0=t.sent,t.next=15;break;case 14:t.t0=void 0;case 15:i.reservedObj=t.t0,i.reservedObj&&(i.reservedObj.images=A(i.reservedObj.UserId,i.RentId)),ct(e,i),t.next=23;break;case 20:t.prev=20,t.t1=t.catch(0),lt(e,t.t1);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(r,e){return t.apply(this,arguments)}}(),Pe=function(){var t=Oe(Ee().mark((function t(r,e){var n,o;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,t.next=6,Le.reserve.getmine(n.Id);case 6:o=t.sent,ct(e,o),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),lt(e,t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(r,e){return t.apply(this,arguments)}}(),Ie=function(){var t=Oe(Ee().mark((function t(r,e){var n,o;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,t.next=6,Le.reserve.getincoming(n.Id);case 6:o=t.sent,ct(e,o),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),lt(e,t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(r,e){return t.apply(this,arguments)}}(),Te=function(){var t=Oe(Ee().mark((function t(r,e){var n,o;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,Le.reserve.getbookedperiods(n);case 4:o=t.sent,ct(e,o),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),lt(e,t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(r,e){return t.apply(this,arguments)}}(),Ae=function(){var t=Oe(Ee().mark((function t(r,e){var n,o,i,a,c,u,s,l;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=r.body,i=o.reservationId,a=o.starsUser,c=o.reviewUser,u=o.starsItem,s=o.reviewItem,t.next=7,Le.reserve.review_by_renter(i,a,c,u,s,n.Id);case 7:l=t.sent,ct(e,l),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),lt(e,t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(r,e){return t.apply(this,arguments)}}(),Ne=function(){var t=Oe(Ee().mark((function t(r,e){var n,o,i,a,c,u;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=r.body,i=o.reservationId,a=o.starsUser,c=o.reviewUser,t.next=7,Le.reserve.review_by_lender(i,a,c,n.Id);case 7:u=t.sent,ct(e,u),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),lt(e,t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(r,e){return t.apply(this,arguments)}}(),Ge=function(){var t=Oe(Ee().mark((function t(r,e){var n,o;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,Le.reserve.getitemreviews(n);case 4:o=t.sent,ct(e,o),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),lt(e,t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(r,e){return t.apply(this,arguments)}}(),Ce=function(){var t=Oe(Ee().mark((function t(r,e){var n,o;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=r.params.id,t.next=4,Le.reserve.getuserreviews(n);case 4:o=t.sent,ct(e,o),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),lt(e,t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(r,e){return t.apply(this,arguments)}}(),Fe=function(){var t=Oe(Ee().mark((function t(r,e){var n,o,i;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=r.params.id,t.next=7,Le.reserve.getreviewbyid(n.Id,o);case 7:i=t.sent,ct(e,i),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),lt(e,t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(r,e){return t.apply(this,arguments)}}();const Re=function(){var r=t.Router();return r.route("/create").post(nr,je),r.route("/getmine").get(nr,Pe),r.route("/incoming").get(nr,Ie),r.route("/getbooked/:id").get(Te),r.route("/get/:id").get(nr,Se),r.route("/reviewrenter").post(nr,Ae),r.route("/reviewlender").post(nr,Ne),r.route("/itemreviews/:id").get(Ge),r.route("/userreviews/:id").get(Ce),r.route("/review/:id").get(nr,Fe),r};function Me(t){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Me(t)}function Ue(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ue=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Me(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Me(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function De(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function Ye(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){De(i,n,o,a,c,"next",t)}function c(t){De(i,n,o,a,c,"throw",t)}a(void 0)}))}}var qe=function(){var t=Ye(Ue().mark((function t(r,e){var n,o,i;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=parseInt(r.params.id),t.next=7,Le.chat.getmsgsclient(n.Id,o);case 7:i=t.sent,ct(e,void 0===i?[]:i),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),lt(e,t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(r,e){return t.apply(this,arguments)}}(),Be=function(){var t=Ye(Ue().mark((function t(r,e){var n,o,i,a,c,u,s;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:return n=r.user,o=parseInt(r.params.id),t.next=7,Le.chat.get_chat_by_id(o);case 7:if(i=t.sent,n.Id===i.UserIdClient||n.Id===i.UserIdHost){t.next=10;break}return t.abrupt("return",st(e,"Not authorized"));case 10:return t.next=12,Le.rent.get_by_id(parseInt(i.RentId));case 12:return a=t.sent,t.next=15,Le.chat.getmsgs_by_chatid(o);case 15:return c=t.sent,u=n.Id===i.UserIdHost?i.UserIdClient:i.UserIdHost,t.next=19,Le.user.getpublicinfo(parseInt(u));case 19:s=t.sent,_r(s),ct(e,{chat:i,messages:void 0===c?[]:c,peerUser:s,rentObj:a}),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(0),lt(e,t.t0);case 28:case"end":return t.stop()}}),t,null,[[0,25]])})));return function(r,e){return t.apply(this,arguments)}}(),He=function(){var t=Ye(Ue().mark((function t(r,e){var n,o,i,a,c,u,s,l;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:if(n=r.user,o=r.body,i=o.UserIdHost,a=o.RentId,c=o.MsgTypeId,u=o.Msg,i&&a){t.next=7;break}return t.abrupt("return",st(e,"UserIdClient, UserIdHost, RentId are required"));case 7:return t.next=9,Le.chat.clientmsg(n.Id,i,a,c,u);case 9:return s=t.sent,t.next=12,Le.user.get_by_id(i);case 12:return l=t.sent,t.next=15,Jt(l,s);case 15:if(t.sent){t.next=17;break}console.log("could not send sendNewChatMessageEmail");case 17:ct(e,s),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),lt(e,t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(r,e){return t.apply(this,arguments)}}(),Je=function(){var t=Ye(Ue().mark((function t(r,e){var n,o,i,a,c,u,s,l;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ht(r,e)){t.next=3;break}return t.abrupt("return");case 3:if(n=r.user,o=r.body,i=o.ChatId,a=o.MsgTypeId,c=o.Msg,i){t.next=7;break}return t.abrupt("return",st(e,"ChatId and RentId required"));case 7:return t.next=9,Le.chat.hostmsg([i,n.Id,a,c]);case 9:return u=t.sent,s=u.UserIdClient,t.next=13,Le.user.get_by_id(s);case 13:return l=t.sent,console.log("req.headers.host=",r.headers.host),t.next=17,Jt(l,u);case 17:if(t.sent){t.next=19;break}console.log("could not send sendNewChatMessageEmail");case 19:ct(e,u),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(0),lt(e,t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,22]])})));return function(r,e){return t.apply(this,arguments)}}();const We=function(){var r=t.Router();return r.route("/clientmsg").post(nr,He),r.route("/hostmsg").post(nr,Je),r.route("/getmsgsclient/:id").get(nr,qe),r.route("/get_by_id/:id").get(nr,Be),r};function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function ze(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ze=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Xe(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Xe(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function Ve(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}const Ze=function(){var r=t.Router();return r.get("/tst",function(){var t,r=(t=ze().mark((function t(r,e){return ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{e.status(200).json({success:!0,message:"Success"})}catch(t){e.status(500).json({success:!1,message:t})}case 1:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){Ve(i,n,o,a,c,"next",t)}function c(t){Ve(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t,e){return r.apply(this,arguments)}}()),r.use("/test",v()),r.use("/user",Or()),r.use("/rent",ne()),r.use("/reserve",Re()),r.use("/chat",We()),r};var $e=function(t,r){r.render("dashboard",{user:{name:"John"}})};const Ke=function(){var r=t.Router();return r.get("/backend",(function(t,r){r.send("Hello from the backend")})),r.get("/set-cookie",(function(t,r){r.cookie("newUser",!1),r.cookie("isEmployee",!0,{maxAge:864e5,secure:!0,httpOnly:!0}),r.send("cookies are set")})),r.get("/read-cookie",(function(t,r){var e=t.cookies;console.log(e),console.log(e.newUser),r.json(e)})),r.get("/dashboard",$e),r};function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function tn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */tn=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Qe(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(Qe(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function rn(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(e=e.call(t)).next,0===r){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=i.call(e)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,r)||function(t,r){if(t){if("string"==typeof t)return en(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?en(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=Array(r);e<r;e++)n[e]=t[e];return n}function nn(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}var on=function(){var t,r=(t=tn().mark((function t(r,e){var n,o,i;return tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J.query("SELECT 1 + 1 AS result");case 2:n=t.sent,o=rn(n,1),i=o[0],e.json(i[0]);case 6:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){nn(i,n,o,a,c,"next",t)}function c(t){nn(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t,e){return r.apply(this,arguments)}}();function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function cn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */cn=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==an(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(an(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function un(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}const sn=function(){var r=t.Router();return r.get("/mysql",function(){var t,r=(t=cn().mark((function t(r,e){return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,on(r,e);case 2:case"end":return t.stop()}}),t)})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){un(i,n,o,a,c,"next",t)}function c(t){un(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t,e){return r.apply(this,arguments)}}()),r.get("/ping",(function(t,r){r.status(200).send("pong! server is running")})),r};var ln={address_components:[{long_name:"Pattaya City",short_name:"Pattaya City",types:["locality","political"]},{long_name:"Bang Lamung District",short_name:"อ.บางละมุง",types:["administrative_area_level_2","political"]},{long_name:"Chon Buri",short_name:"จ.ชลบุรี",types:["administrative_area_level_1","political"]},{long_name:"Thailand",short_name:"TH",types:["country","political"]},{long_name:"20150",short_name:"20150",types:["postal_code"]}],formatted_address:"Pattaya City, Bang Lamung District, Chon Buri 20150, Thailand",geometry:{bounds:{northeast:{lat:13.0019977,lng:100.9896282},southwest:{lat:12.7713929,lng:100.8558912}},location:{lat:12.923594,lng:100.8824376},location_type:"APPROXIMATE",viewport:{northeast:{lat:13.0019977,lng:100.9896282},southwest:{lat:12.7713929,lng:100.8558912}}},place_id:"ChIJ49cxTZKVAjER_xC9qQHzf6k",types:["locality","political"]},fn={address_components:[{long_name:"Bangkok",short_name:"กทม",types:["locality","political"]},{long_name:"Bangkok",short_name:"Bangkok",types:["administrative_area_level_1","political"]},{long_name:"Thailand",short_name:"TH",types:["country","political"]}],formatted_address:"Bangkok, Thailand",geometry:{bounds:{northeast:{lat:13.955111,lng:100.938408},southwest:{lat:13.4940881,lng:100.3278136}},location:{lat:13.7563309,lng:100.5017651},location_type:"APPROXIMATE",viewport:{northeast:{lat:13.955111,lng:100.938408},southwest:{lat:13.4940881,lng:100.3278136}}},place_id:"ChIJ82ENKDJgHTERIEjiXbIAAQE",types:["locality","political"]},hn={address_components:[{long_name:"Chiang Mai",short_name:"Chiang Mai",types:["locality","political"]},{long_name:"Mueang Chiang Mai District",short_name:"Mueang Chiang Mai District",types:["administrative_area_level_2","political"]},{long_name:"Chiang Mai",short_name:"จ.เชียงใหม่",types:["administrative_area_level_1","political"]},{long_name:"Thailand",short_name:"TH",types:["country","political"]}],formatted_address:"Chiang Mai, Mueang Chiang Mai District, Chiang Mai, Thailand",geometry:{bounds:{northeast:{lat:18.8440597,lng:99.0512218},southwest:{lat:18.7444321,lng:98.86173269999999}},location:{lat:18.7883439,lng:98.98530079999999},location_type:"APPROXIMATE",viewport:{northeast:{lat:18.8440597,lng:99.0512218},southwest:{lat:18.7444321,lng:98.86173269999999}}},place_id:"ChIJXW-7kH462jARZ0ObpXBi1Jg",types:["locality","political"]},pn={address_components:[{long_name:"Mueang Chiang Rai",short_name:"Mueang Chiang Rai",types:["locality","political"]},{long_name:"Mueang Chiang Rai District",short_name:"อ.เมืองเชียงราย",types:["administrative_area_level_2","political"]},{long_name:"Chiang Rai",short_name:"จ.เชียงราย",types:["administrative_area_level_1","political"]},{long_name:"Thailand",short_name:"TH",types:["country","political"]}],formatted_address:"Mueang Chiang Rai, Mueang Chiang Rai District, Chiang Rai, Thailand",geometry:{bounds:{northeast:{lat:20.0192785,lng:99.9832242},southwest:{lat:19.8240382,lng:99.77422469999999}},location:{lat:19.9104798,lng:99.840576},location_type:"APPROXIMATE",viewport:{northeast:{lat:20.0192785,lng:99.9832242},southwest:{lat:19.8240382,lng:99.77422469999999}}},place_id:"ChIJZYPDE2cG1zARNwa2sbtUFXE",types:["locality","political"]};function yn(t){return yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yn(t)}function vn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */vn=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==yn(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(yn(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function dn(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}const gn=function(t){t.use("/api",Ze()),t.use("/test",Ke()),t.use("/status",sn()),t.get("/api/geocode",function(){var t,r=(t=vn().mark((function t(r,n){var o,i,a,c;return vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,o=r.query.address,t.t0=o,t.next="Pattaya"===t.t0?5:"Bangkok"===t.t0?6:"Chiang Mai"===t.t0?7:"Chiang Rai"===t.t0?8:9;break;case 5:return t.abrupt("return",ct(n,ln));case 6:return t.abrupt("return",ct(n,fn));case 7:return t.abrupt("return",ct(n,hn));case 8:return t.abrupt("return",ct(n,pn));case 9:return console.log("".concat(o," is NOT IN CACHE")),i={address:o,key:process.env.GOOGLE_MAPS_SRV_API_KEY},t.next=13,e.get("https://maps.googleapis.com/maps/api/geocode/json",{params:i});case 13:a=t.sent,(c=a.data.results).length>0?ct(n,c[0]):st(n,"Location not found"),t.next=22;break;case 18:t.prev=18,t.t1=t.catch(0),console.log(t.t1),lt(n,t.t1);case 22:case"end":return t.stop()}}),t,null,[[0,18]])})),function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){dn(i,n,o,a,c,"next",t)}function c(t){dn(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t,e){return r.apply(this,arguments)}}()),t.get("/*",(function(t,r,e){var n=t.originalUrl.toLowerCase();if(n.includes(".jpg")||n.includes(".png")||n.includes(".jpeg")){if(e)return e()}else r.redirect("".concat(process.env.BASE_URL,"/?url=")+n)}))};const mn=require("rotating-file-stream"),wn=require("morgan"),bn=require("cors");function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function Ln(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ln=function(){return r};var t,r={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,r,e){t[r]=e.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{s({},"")}catch(t){s=function(t,r,e){return t[r]=e}}function l(t,r,e,n){var i=r&&r.prototype instanceof g?r:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:O(t,e,c)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}r.wrap=l;var h="suspendedStart",p="suspendedYield",y="executing",v="completed",d={};function g(){}function m(){}function w(){}var b={};s(b,a,(function(){return this}));var x=Object.getPrototypeOf,L=x&&x(x(T([])));L&&L!==e&&n.call(L,a)&&(b=L);var _=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(r){s(t,r,(function(t){return this._invoke(r,t)}))}))}function k(t,r){function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==xn(l)&&n.call(l,"__await")?r.resolve(l.__await).then((function(t){e("next",t,a,c)}),(function(t){e("throw",t,a,c)})):r.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return e("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new r((function(r,o){e(t,n,r,o)}))}return i=i?i.then(o,o):o()}})}function O(r,e,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=j(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(r,e,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function j(r,e){var n=e.method,o=r.iterator[n];if(o===t)return e.delegate=null,"throw"===n&&r.iterator.return&&(e.method="return",e.arg=t,j(r,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var i=f(o,r.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var a=i.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function P(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function T(r){if(r||""===r){var e=r[a];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var o=-1,i=function e(){for(;++o<r.length;)if(n.call(r,o))return e.value=r[o],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(xn(r)+" is not iterable")}return m.prototype=w,o(_,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,u,"GeneratorFunction"),r.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,u,"GeneratorFunction")),t.prototype=Object.create(_),t},r.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,c,(function(){return this})),r.AsyncIterator=k,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(_),s(_,u,"Generator"),s(_,a,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=T,I.prototype={constructor:I,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!r)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function o(n,o){return c.type="throw",c.arg=r,e.next=n,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),d},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),P(e),d}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;P(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(r,e,n){return this.delegate={iterator:T(r),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=t),d}},r}function _n(t,r,e,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?r(u):Promise.resolve(u).then(n,o)}function En(t){return function(){var r=this,e=arguments;return new Promise((function(n,o){var i=t.apply(r,e);function a(t){_n(i,n,o,a,c,"next",t)}function c(t){_n(i,n,o,a,c,"throw",t)}a(void 0)}))}}var kn,On=require("redis").createClient({url:process.env.redis_url}),jn=function(){var t=En(Ln().mark((function t(){return Ln().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,On.connect();case 3:return t.next=5,On.ping();case 5:return console.log("Redis is online and working"),t.next=8,On.disconnect();case 8:return t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(0),console.warn("Warning: Unable to connect to Redis"),console.error(t.t0),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}(),Sn=function(){var t=En(Ln().mark((function t(){return Ln().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,jn();case 2:if(!t.sent){t.next=7;break}On.on("error",(function(t){console.error("Redis Client Error",t)})),t.next=9;break;case 7:return t.next=9,On.disconnect();case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();n.config(),console.log("ENV variables from .env file:"),console.log(" SERVER_PORT: "+process.env.SERVER_PORT),console.log(" DATABASE_HOST: "+process.env.DATABASE_HOST),console.log(" DATABASE_PORT: "+process.env.DATABASE_PORT),console.log(" DATABASE_USER: "+process.env.DATABASE_USER),kn={connectionLimit:10,host:process.env.DATABASE_HOST,user:process.env.DATABASE_USER,password:process.env.DATABASE_PASSWORD,database:process.env.DATABASE_NAME||"myhorse".concat(x.Id),port:process.env.DATABASE_PORT,dateStrings:!0},B=(0,F.createPool)(kn),Sn();var Pn=t();Pn.use(bn({origin:!0,credentials:!0,optionSuccessStatus:200}));var In=mn.createStream("access.log",{interval:"1d",path:d.join(j,"logs")});Pn.use(wn("combined",{stream:In})),Pn.use(t.static("public")),Pn.get("/favicon.ico",(function(t,r){r.status(204)})),Pn.get("/robots.txt",(function(t,r){r.status(204)})),Pn.use(t.json()),Pn.use(t.urlencoded({extended:!0})),Pn.use(l()),Pn.use(r({secret:"secret-key",resave:!1,saveUninitialized:!1,cookie:{maxAge:6e4}})),gn(Pn),Pn.set("view engine","ejs"),Pn.use((function(t,r,e){console.log("404 - Url not Found:"+(null==t?void 0:t.originalUrl)),r.status(404).end("404 - Url not Found")}));Pn.use((function(t,r,e,n){console.log("errorHandler:"+(null==r?void 0:r.originalUrl)),console.error(t.stack),e.status(500).send(" Something went wrong! Please reload the site by navigating to: "+process.env.BASE_URL)})),s(Pn)})();